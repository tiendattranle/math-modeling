<?xml version="1.0" encoding="UTF-8"?>
<pnml xmlns="http://www.pnml.org/version-2009/grammar/ptnet">
  <net id="mutexNet" type="http://www.pnml.org/version-2009/grammar/ptnet">

    <!-- Test case: Mutual Exclusion (Mutex/Semaphore Pattern) -->
    <!-- Classic mutex with semaphore controlling access to critical sections -->
    <!-- At most one process can be in critical section at a time -->
    <!-- Expected: Never have both critical1 and critical2 with tokens -->

    <!-- Places -->
    <place id="semaphore">
      <name><text>Semaphore</text></name>
      <initialMarking><text>1</text></initialMarking>
    </place>

    <place id="waiting1">
      <name><text>Waiting1</text></name>
      <initialMarking><text>1</text></initialMarking>
    </place>

    <place id="critical1">
      <name><text>Critical1</text></name>
      <initialMarking><text>0</text></initialMarking>
    </place>

    <place id="waiting2">
      <name><text>Waiting2</text></name>
      <initialMarking><text>1</text></initialMarking>
    </place>

    <place id="critical2">
      <name><text>Critical2</text></name>
      <initialMarking><text>0</text></initialMarking>
    </place>

    <!-- Transitions -->
    <transition id="acquire1">
      <name><text>Process1_Acquire</text></name>
    </transition>

    <transition id="release1">
      <name><text>Process1_Release</text></name>
    </transition>

    <transition id="acquire2">
      <name><text>Process2_Acquire</text></name>
    </transition>

    <transition id="release2">
      <name><text>Process2_Release</text></name>
    </transition>

    <!-- Arcs for Process 1 -->
    <arc id="a1" source="waiting1" target="acquire1">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a2" source="semaphore" target="acquire1">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a3" source="acquire1" target="critical1">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a4" source="critical1" target="release1">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a5" source="release1" target="waiting1">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a6" source="release1" target="semaphore">
      <inscription><text>1</text></inscription>
    </arc>

    <!-- Arcs for Process 2 -->
    <arc id="a7" source="waiting2" target="acquire2">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a8" source="semaphore" target="acquire2">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a9" source="acquire2" target="critical2">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a10" source="critical2" target="release2">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a11" source="release2" target="waiting2">
      <inscription><text>1</text></inscription>
    </arc>

    <arc id="a12" source="release2" target="semaphore">
      <inscription><text>1</text></inscription>
    </arc>

    <!-- Property to check: Never (critical1=1 AND critical2=1) -->

  </net>
</pnml>
